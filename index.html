<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ Mission Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Noto Sans SC', sans-serif; }
        body { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); min-height: 100vh; }
        .glass { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
        .task-card { transition: all 0.3s; }
        .task-card:hover { transform: translateY(-2px); background: rgba(255,255,255,0.1); }
        .work-card { transition: all 0.3s; }
        .work-card:hover { transform: translateY(-2px); background: rgba(255,255,255,0.1); }
        .status-running { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .btn-success { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); }
    </style>
</head>
<body class="p-6">
    <div class="max-w-6xl mx-auto">
        <!-- Header -->
        <div class="glass rounded-2xl p-6 mb-6 flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-bold text-white">ğŸ¯ Mission Center</h1>
                <p class="text-gray-400 text-sm mt-1">ä»»åŠ¡æŒ‡æŒ¥ä¸­å¿ƒ</p>
            </div>
            <button onclick="openNewTaskModal()" class="btn-primary px-6 py-2 rounded-xl text-white font-medium">
                + æ–°å»ºä»»åŠ¡
            </button>
        </div>

        <!-- Stats -->
        <div class="grid grid-cols-4 gap-4 mb-6">
            <div class="glass rounded-xl p-4 text-center">
                <div class="text-3xl font-bold text-green-400" id="totalTasks">0</div>
                <div class="text-gray-400 text-sm">æ€»ä»»åŠ¡æ•°</div>
            </div>
            <div class="glass rounded-xl p-4 text-center">
                <div class="text-3xl font-bold text-blue-400" id="activeTasks">0</div>
                <div class="text-gray-400 text-sm">è¿è¡Œä¸­</div>
            </div>
            <div class="glass rounded-xl p-4 text-center">
                <div class="text-3xl font-bold text-yellow-400" id="pendingTasks">0</div>
                <div class="text-gray-400 text-sm">å¾…æ‰§è¡Œ</div>
            </div>
            <div class="glass rounded-xl p-4 text-center">
                <div class="text-3xl font-bold text-red-400" id="errorTasks">0</div>
                <div class="text-gray-400 text-sm">é”™è¯¯</div>
            </div>
        </div>

        <!-- Task List -->
        <div class="glass rounded-2xl p-6 mb-6">
            <h2 class="text-xl font-bold text-white mb-4">ğŸ“‹ ä»»åŠ¡åˆ—è¡¨</h2>
            <div id="taskList" class="space-y-3"></div>
        </div>

        <!-- Works Library -->
        <div class="glass rounded-2xl p-6 mb-6">
            <div class="flex flex-wrap justify-between items-center gap-3 mb-4">
                <h2 class="text-xl font-bold text-white">ğŸ—‚ï¸ ä½œå“åº“</h2>
                <button onclick="loadDefaultWorks()" class="bg-white/10 hover:bg-white/20 px-4 py-2 rounded-xl text-white text-sm">
                    å¯¼å…¥é»˜è®¤ä½œå“
                </button>
            </div>
            <form id="newWorkForm" onsubmit="createWork(event)" class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-4">
                <input type="text" id="workTitle" required class="p-3 bg-white/10 rounded-xl text-white" placeholder="ä½œå“æ ‡é¢˜">
                <input type="text" id="workPlatform" required class="p-3 bg-white/10 rounded-xl text-white" placeholder="å‘å¸ƒå¹³å°">
                <select id="workStatus" class="p-3 bg-white/10 rounded-xl text-white">
                    <option value="è‰ç¨¿">è‰ç¨¿</option>
                    <option value="å·²å‘å¸ƒ">å·²å‘å¸ƒ</option>
                    <option value="è¿›è¡Œä¸­">è¿›è¡Œä¸­</option>
                </select>
                <button type="submit" class="btn-primary rounded-xl text-white font-medium">+ æ·»åŠ ä½œå“</button>
            </form>
            <div id="worksList" class="space-y-3"></div>
        </div>

        <!-- Available Tools -->
        <div class="glass rounded-2xl p-6">
            <h2 class="text-xl font-bold text-white mb-4">ğŸ”§ å¯ç”¨å·¥å…·</h2>
            <div class="grid grid-cols-3 gap-3" id="toolsList">
                <div class="glass rounded-xl p-3">
                    <div class="font-medium text-white">ğŸŒ Browser</div>
                    <div class="text-gray-400 text-sm">ç½‘é¡µæµè§ˆã€æˆªå›¾</div>
                </div>
                <div class="glass rounded-xl p-3">
                    <div class="font-medium text-white">ğŸ” Web Search</div>
                    <div class="text-gray-400 text-sm">Braveæœç´¢</div>
                </div>
                <div class="glass rounded-xl p-3">
                    <div class="font-medium text-white">ğŸ“° RSS</div>
                    <div class="text-gray-400 text-sm">RSSç›‘æ§</div>
                </div>
                <div class="glass rounded-xl p-3">
                    <div class="font-medium text-white">ğŸ¦ Twitter</div>
                    <div class="text-gray-400 text-sm">X/Twitterç›‘æ§</div>
                </div>
                <div class="glass rounded-xl p-3">
                    <div class="font-medium text-white">ğŸ’¬ Feishu</div>
                    <div class="text-gray-400 text-sm">é£ä¹¦æ¶ˆæ¯</div>
                </div>
                <div class="glass rounded-xl p-3">
                    <div class="font-medium text-white">â° Cron</div>
                    <div class="text-gray-400 text-sm">å®šæ—¶ä»»åŠ¡</div>
                </div>
                <div class="glass rounded-xl p-3">
                    <div class="font-medium text-white">ğŸ’» Exec</div>
                    <div class="text-gray-400 text-sm">å‘½ä»¤è¡Œæ‰§è¡Œ</div>
                </div>
                <div class="glass rounded-xl p-3">
                    <div class="font-medium text-white">ğŸ“ Memory</div>
                    <div class="text-gray-400 text-sm">è®°å¿†å­˜å‚¨</div>
                </div>
                <div class="glass rounded-xl p-3">
                    <div class="font-medium text-white">ğŸ™ GitHub</div>
                    <div class="text-gray-400 text-sm">Gitæ“ä½œ</div>
                </div>
            </div>
        </div>
    </div>

    <!-- New Task Modal -->
    <div id="newTaskModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center p-4">
        <div class="glass p-6 w-full max-w-2xl">
            <h2 class="text-xl font-bold text-white mb-4">â• æ–°å»ºä»»åŠ¡</h2>
            <form id="newTaskForm" onsubmit="createTask(event)">
                <div class="space-y-4">
                    <div>
                        <label class="block text-gray-400 text-sm mb-1">ä»»åŠ¡åç§°</label>
                        <input type="text" id="taskName" required class="w-full p-3 bg-white/10 rounded-xl text-white" placeholder="ä¾‹å¦‚ï¼šæ¯æ—¥æ—©æŠ¥">
                    </div>
                    <div>
                        <label class="block text-gray-400 text-sm mb-1">ä»»åŠ¡æè¿°</label>
                        <textarea id="taskDesc" rows="2" class="w-full p-3 bg-white/10 rounded-xl text-white" placeholder="ä»»åŠ¡è¯¦ç»†æè¿°"></textarea>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-gray-400 text-sm mb-1">è§¦å‘ç±»å‹</label>
                            <select id="triggerType" class="w-full p-3 bg-white/10 rounded-xl text-white">
                                <option value="cron">Cronè¡¨è¾¾å¼</option>
                                <option value="interval">é—´éš”æ‰§è¡Œ</option>
                                <option value="manual">æ‰‹åŠ¨è§¦å‘</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-400 text-sm mb-1">æ‰§è¡Œæ—¶é—´</label>
                            <input type="text" id="schedule" class="w-full p-3 bg-white/10 rounded-xl text-white" placeholder="0 7 * * *">
                        </div>
                    </div>
                    <div>
                        <label class="block text-gray-400 text-sm mb-1">ä½¿ç”¨å·¥å…·ï¼ˆå¤šé€‰ï¼‰</label>
                        <div class="flex flex-wrap gap-2" id="toolCheckboxes">
                            <label class="flex items-center gap-2 text-white bg-white/10 px-3 py-1 rounded-lg">
                                <input type="checkbox" name="tools" value="web_search"> ğŸŒ æœç´¢
                            </label>
                            <label class="flex items-center gap-2 text-white bg-white/10 px-3 py-1 rounded-lg">
                                <input type="checkbox" name="tools" value="rss"> ğŸ“° RSS
                            </label>
                            <label class="flex items-center gap-2 text-white bg-white/10 px-3 py-1 rounded-lg">
                                <input type="checkbox" name="tools" value="twitter"> ğŸ¦ Twitter
                            </label>
                            <label class="flex items-center gap-2 text-white bg-white/10 px-3 py-1 rounded-lg">
                                <input type="checkbox" name="tools" value="feishu"> ğŸ’¬ é£ä¹¦
                            </label>
                            <label class="flex items-center gap-2 text-white bg-white/10 px-3 py-1 rounded-lg">
                                <input type="checkbox" name="tools" value="github"> ğŸ™ GitHub
                            </label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-gray-400 text-sm mb-1">è¾“å‡ºç›®æ ‡</label>
                        <select id="outputTarget" class="w-full p-3 bg-white/10 rounded-xl text-white">
                            <option value="feishu">é£ä¹¦ç§ä¿¡</option>
                            <option value="github">GitHub</option>
                            <option value="both">é£ä¹¦+GitHub</option>
                        </select>
                    </div>
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="button" onclick="closeNewTaskModal()" class="flex-1 p-3 bg-white/10 rounded-xl text-white">å–æ¶ˆ</button>
                    <button type="submit" class="flex-1 btn-primary p-3 rounded-xl text-white font-medium">åˆ›å»ºä»»åŠ¡</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Task data persistence
        const TASK_STORAGE_KEY = 'mission_center_tasks';
        const WORK_STORAGE_KEY = 'mission_center_works';
        const defaultTasks = [
            { id: 1, name: 'è¡Œä¸šæ—©æŠ¥', desc: 'æ¯å¤©7:00ç”ŸæˆAI/æœºå™¨äººè¡Œä¸šæ—©æŠ¥', trigger: 'cron 0 7 * * *', tools: ['web_search','rss','twitter','feishu','github'], status: 'pending', lastRun: '2026-02-20 07:00' },
            { id: 2, name: 'çµæ„Ÿåº“å»ºè®®', desc: 'æ£€æµ‹æ–°çµæ„Ÿå¹¶ç”Ÿæˆåˆ›ä½œå»ºè®®', trigger: 'interval 5min', tools: ['github','feishu'], status: 'running', lastRun: '2026-02-20 16:45' },
            { id: 3, name: 'AIå­¦ä¹ æé†’', desc: 'æ¯å¤©10:00æé†’å­¦ä¹ ', trigger: 'cron 0 10 * * *', tools: ['feishu'], status: 'pending', lastRun: '2026-02-20 10:00' },
            { id: 4, name: 'å‘¨æŠ¥ç”Ÿæˆ', desc: 'æ¯å‘¨ä¸€8:00ç”Ÿæˆå‘¨æŠ¥', trigger: 'cron 0 8 * * 1', tools: ['web_search','feishu','github'], status: 'pending', lastRun: '2026-02-16 08:00' }
        ];
        const defaultWorks = [
            { id: 101, title: 'äººå½¢æœºå™¨äººäº§ä¸šåˆ†æ', platform: 'å…¬ä¼—å·', status: 'å·²å‘å¸ƒ', createdAt: '2026/2/20 09:00:00' },
            { id: 102, title: 'æ˜¥æ™šæœºå™¨äººå¹•åè§‚å¯Ÿ', platform: 'å°çº¢ä¹¦', status: 'è¿›è¡Œä¸­', createdAt: '2026/2/20 13:30:00' },
            { id: 103, title: 'Atlas ç©ºç¿»æ‹†è§£çŸ­æ–‡', platform: 'å³åˆ»', status: 'è‰ç¨¿', createdAt: '2026/2/21 08:15:00' },
            { id: 104, title: 'ä¸­å›½äººå½¢æœºå™¨äººæ€ç–¯äº†ï¼ä»è·Œå€’åˆ°ç©ºç¿»åªç”¨ä¸€å¹´', platform: 'å°çº¢ä¹¦', status: 'è‰ç¨¿', createdAt: '2026/2/21 20:40:00' },
            { id: 105, title: 'åœŸè€³å…¶æ­¦å™¨æœºå™¨ç‹—SARBOT', platform: 'å°çº¢ä¹¦', status: 'è‰ç¨¿', createdAt: '2026/2/20 10:00:00' },
            { id: 106, title: 'æœºå™¨äººåŠ³åŠ¡ä¸Šé“¾ï¼konnex_worldè·1500ä¸‡èèµ„', platform: 'å…¬ä¼—å·', status: 'è‰ç¨¿', createdAt: '2026/2/20 14:00:00' },
            { id: 107, title: 'å‰è°·æ­ŒCEOæ–¯å¦ç¦è®¿è°ˆæ³„éœ²ï¼šAIå°†å–ä»£ä½æŠ€èƒ½å·¥ä½œ', platform: 'å°çº¢ä¹¦', status: 'è‰ç¨¿', createdAt: '2026/2/20 16:00:00' },
            { id: 108, title: 'Sam Altmanï¼šä¸–ç•Œè¿˜æ²¡å‡†å¤‡å¥½ï¼ŒAIèµ·é£æ¯”é¢„æƒ³çš„å¿«', platform: 'å°çº¢ä¹¦', status: 'è‰ç¨¿', createdAt: '2026/2/21 21:05:00' },
            { id: 109, title: 'NVIDIAå¼€æºDreamDojoï¼šæœºå™¨äººä¸–ç•Œæ¨¡å‹æ–°æ—¶ä»£', platform: 'å°çº¢ä¹¦', status: 'è‰ç¨¿', createdAt: '2026/2/21 21:06:00' }
        ];
        let tasks = [];
        let works = [];

        function saveTasks() {
            localStorage.setItem(TASK_STORAGE_KEY, JSON.stringify(tasks));
        }

        function loadTasks() {
            const stored = localStorage.getItem(TASK_STORAGE_KEY);
            if (!stored) {
                tasks = [...defaultTasks];
                saveTasks();
                return;
            }

            try {
                const parsed = JSON.parse(stored);
                if (Array.isArray(parsed)) {
                    tasks = parsed;
                    return;
                }
            } catch (e) {}

            tasks = [...defaultTasks];
            saveTasks();
        }

        function saveWorks() {
            localStorage.setItem(WORK_STORAGE_KEY, JSON.stringify(works));
        }

        function loadWorks() {
            const stored = localStorage.getItem(WORK_STORAGE_KEY);
            if (!stored) {
                works = [...defaultWorks];
                saveWorks();
                return;
            }

            try {
                const parsed = JSON.parse(stored);
                if (Array.isArray(parsed)) {
                    works = parsed;
                    return;
                }
            } catch (e) {}

            works = [...defaultWorks];
            saveWorks();
        }

        function renderWorks() {
            const list = document.getElementById('worksList');
            if (!list) return;

            if (works.length === 0) {
                list.innerHTML = '<div class="text-gray-500 text-center py-6">æš‚æ— ä½œå“</div>';
                return;
            }

            list.innerHTML = works.map(w => `
                <div class="work-card glass rounded-xl p-4 flex justify-between items-center">
                    <div>
                        <div class="text-white font-medium">${w.title}</div>
                        <div class="text-gray-400 text-sm mt-1">å¹³å°ï¼š${w.platform}</div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm ${
                            w.status === 'å·²å‘å¸ƒ' ? 'text-green-400' :
                            w.status === 'è¿›è¡Œä¸­' ? 'text-blue-400' : 'text-yellow-400'
                        }">${w.status}</div>
                        <div class="text-gray-500 text-xs mt-1">${w.createdAt}</div>
                    </div>
                </div>
            `).join('');
        }

        function createWork(e) {
            e.preventDefault();
            const title = document.getElementById('workTitle').value.trim();
            const platform = document.getElementById('workPlatform').value.trim();
            const status = document.getElementById('workStatus').value;

            if (!title || !platform) return;

            works.unshift({
                id: Date.now(),
                title,
                platform,
                status,
                createdAt: new Date().toLocaleString('zh-CN')
            });

            saveWorks();
            renderWorks();
            document.getElementById('newWorkForm').reset();
        }

        function loadDefaultWorks() {
            const existingIds = new Set(works.map(w => w.id));
            const additions = defaultWorks.filter(w => !existingIds.has(w.id));
            works = [...additions, ...works];
            saveWorks();
            renderWorks();
        }

        function render() {
            // Stats
            document.getElementById('totalTasks').textContent = tasks.length;
            document.getElementById('activeTasks').textContent = tasks.filter(t => t.status === 'running').length;
            document.getElementById('pendingTasks').textContent = tasks.filter(t => t.status === 'pending').length;
            document.getElementById('errorTasks').textContent = tasks.filter(t => t.status === 'error').length;

            // Task list
            const list = document.getElementById('taskList');
            if (tasks.length === 0) {
                list.innerHTML = '<div class="text-gray-500 text-center py-8">æš‚æ— ä»»åŠ¡</div>';
                return;
            }

            list.innerHTML = tasks.map(t => `
                <div class="task-card glass rounded-xl p-4 flex justify-between items-center">
                    <div>
                        <div class="flex items-center gap-2">
                            <span class="text-white font-medium">${t.name}</span>
                            <span class="px-2 py-0.5 rounded-full text-xs ${
                                t.status === 'running' ? 'bg-green-500/20 text-green-400 status-running' :
                                t.status === 'error' ? 'bg-red-500/20 text-red-400' :
                                'bg-yellow-500/20 text-yellow-400'
                            }">${t.status === 'running' ? 'è¿è¡Œä¸­' : t.status === 'error' ? 'é”™è¯¯' : 'å¾…æ‰§è¡Œ'}</span>
                        </div>
                        <div class="text-gray-400 text-sm mt-1">${t.desc}</div>
                        <div class="text-gray-500 text-xs mt-1">â° ${t.trigger} | ğŸ”§ ${t.tools.join(', ')}</div>
                    </div>
                    <div class="text-right">
                        <div class="text-gray-400 text-sm">ä¸Šæ¬¡: ${t.lastRun}</div>
                        <div class="flex gap-2 mt-2">
                            <button onclick="runTask(${t.id})" class="btn-success px-3 py-1 rounded-lg text-sm">æ‰§è¡Œ</button>
                            <button onclick="deleteTask(${t.id})" class="bg-red-500/20 text-red-400 px-3 py-1 rounded-lg text-sm">åˆ é™¤</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function openNewTaskModal() {
            document.getElementById('newTaskModal').classList.remove('hidden');
            document.getElementById('newTaskModal').classList.add('flex');
        }

        function closeNewTaskModal() {
            document.getElementById('newTaskModal').classList.add('hidden');
            document.getElementById('newTaskModal').classList.remove('flex');
        }

        function createTask(e) {
            e.preventDefault();
            const name = document.getElementById('taskName').value;
            const desc = document.getElementById('taskDesc').value;
            const triggerType = document.getElementById('triggerType').value;
            const schedule = document.getElementById('schedule').value;
            const output = document.getElementById('outputTarget').value;
            
            const tools = Array.from(document.querySelectorAll('input[name="tools"]:checked')).map(cb => cb.value);

            const newTask = {
                id: Date.now(),
                name,
                desc,
                trigger: triggerType === 'manual' ? 'æ‰‹åŠ¨' : schedule,
                tools: tools.length ? tools : ['manual'],
                status: 'pending',
                lastRun: '-'
            };

            tasks.push(newTask);
            saveTasks();
            render();
            closeNewTaskModal();
            document.getElementById('newTaskForm').reset();
        }

        function runTask(id) {
            const task = tasks.find(t => t.id === id);
            if (task) {
                task.status = 'running';
                task.lastRun = new Date().toLocaleString('zh-CN');
                saveTasks();
                render();
                // Simulate completion
                setTimeout(() => {
                    task.status = 'pending';
                    saveTasks();
                    render();
                }, 3000);
            }
        }

        function deleteTask(id) {
            tasks = tasks.filter(t => t.id !== id);
            saveTasks();
            render();
        }

        // Auto-refresh
        loadTasks();
        loadWorks();
        render();
        renderWorks();
        setInterval(render, 5000);
    </script>
</body>
</html>
